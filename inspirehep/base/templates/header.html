{#
# This file is part of INSPIRE.
# Copyright (C) 2014, 2015, 2016 CERN.
#
# INSPIRE is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License as
# published by the Free Software Foundation; either version 2 of the
# License, or (at your option) any later version.
#
# INSPIRE is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with INSPIRE; if not, write to the Free Software Foundation, Inc.,
# 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#}

{#
## This file contains header part of main page template.
##
## Usage:
## {% include 'header.html' %}
#}

{#
## structure: (endpoint, values, blueprint, caption)
#}
{% set navigation_bar = [
  ('/tools/', {}, '', 'Tools'),
  ('/links-stats/', {}, '', 'Links and stats'),
  ('webdeposit.create', {"deposition_type": "literature"}, 'webdeposit', 'Submit'),
  ('https://labs.inspirehep.net/help', {}, '', 'Help'),
] -%}

{# Work-around for collection name #}

{% if collection is defined %}
 {% set collection_name = collection.name | sanitize_collection_name %}
{% else %}
  {% set collection_name = '' %}
{% endif %}

<section id="header-section">
  <nav id="topnav" class="navbar navbar-fixed-top navbar-inverse navbar-custom" role="navigation">
    <div class="navbar-header">
      <div id="mobile-header">
        <a class="navbar-brand" href="{{ url_for('collections.index') }}">
          <span id="{{ collection_name | sanitize_collection_name }}-collection">
            {% include 'labs-logo.svg' %}
          </span>
        </a>
        <button type="button" id="topnav-button" class="navbar-toggle collapsed" data-target=".navbar-ex1-collapse" data-toggle="modal" data-backdrop="static">
          <span class="sr-only">{{ _("Toggle navigation") }}</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      </div>
      <div class="navbar-collapse navbar-ex1-collapse collapse overflow" id="topnav-right">

        <div class="row" id="mobile-menu">
          <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/literature" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-literature.svg') }}">
              <p id="literature-collection">Literature</p>
            </a>
          </div>
          <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/authors" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-authors.svg') }}" >
              <p id="authors-collection">Authors</p>
            </a>
          </div>
          <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/data" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-data.svg') }}" >
              <p id="data-collection">Data</p>
            </a>
         </div>
           <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/conferences" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-conferences.svg') }}" >
              <p id="conferences-collection">Conferences</p>
            </a>
         </div>
           <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/jobs" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-jobs.svg') }}" >
              <p id="jobs-collection">Jobs</p>
            </a>
          </div>
          <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/institutions" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-institutions.svg') }}" >
              <p id="institutions-collection">Institutions</p>
            </a>
          </div>
          <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/experiments" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-experiments.svg') }}" >
              <p id="experiments-collection">Experiments</p>
            </a>
         </div>
           <div class="col-sm-3 col-xs-4 col-xxs-6">
            <div class="mobile-menu-square"></div>
            <a href="/journals" class="mobile-menu-thumbnail">
              <img src="{{ url_for('static', filename='img/mobile-menu-icon-journals.svg') }}" >
              <p id="journals-collection">Journals</p>
            </a>
         </div>
        </div>

        <ul class="nav navbar-nav" id="header-links">
          {% for endpoint, values, blueprint, caption in navigation_bar %}
          <li {% if request.blueprint == blueprint|e %} class="active" {% endif %}>
            <a href={% if blueprint %}"{{ url_for( endpoint|e, **values ) }}"{% else %}{{endpoint}}{% endif %}>{{- _(caption|e) -}}</a>
          </li>
          {% endfor %}
          <li class="divider-vertical"></li>
          {%- if current_user.is_guest %}
          <li id="mobile-sign-in">
            <a class="" href="{{ url_for('webaccount.login')}}">
              <i class="glyphicon glyphicon-log-in"></i> {{ _("Sign in") }}
            </a>
          </li>
          {%- else %}
          <li class="dropdown" >
            <a id="user-info" class="dropdown-toggle" data-toggle="dropdown" href="#">
              <i class="glyphicon glyphicon-user"></i>
              {%- if current_user.email %}
                My account
              {%- endif %}
              <!-- <span class="caret"></span> -->
              <span id="arrow-handler" class="down-arrow right-arrow-small-screen"></span>
            </a>
            <ul class="dropdown-menu dropdown-menu-arrow" role="menu">
              <li>
                <a href="{{ url_for( 'accounts_settings.profile' ) }}" class="list-group-item list-item">
                  <div class="dropdown-element-body">
                    <span class="custom-dropdown-header">{{ _('Settings') }}</span>
                    <span class="text-muted small-text">{{ _('Manage your personal settings') }}</span>
                  </div>
                </a>
              </li>
              <li class="divider custom-divider-dropdown"></li>
              <div class="row"><div class="col-md-12"><p></p></div></div>
              <div class="row"><div class="col-md-12"><p></p></div></div>
              <li >
                <div class="text-center">
                  <a  role="menuitem" tabindex="-1" href="{{ url_for('webaccount.logout') }}">
                    <button type="button" class="btn btn-info btn-sign-out">{{ _('Sign out') }}</button>
                  </a>
                </div>
              </li>
            </ul>
          </li>
          {%- endif %}
          </li>
        </ul>
      </div>
      {% if request.endpoint in ['search.search', 'record.metadata'] %}
        <div id="top-search-bar" class="{{collection_name}}">
          {% include "search/form/form.html" %}
        </div>
      {% endif %}
    </div>
  </nav>
</section>

<section id="collections-section">
  <nav id="collections-nav">
      <a href="/literature" id="literature-collection" class="{{collection_name | collection_select_current("Literature") }}">
        Literature
      </a>
      <a href="/authors" id="authors-collection" class="{{collection_name | collection_select_current("Authors") }}">
        Authors
      </a>
      <a href="/data" id="data-collection" class="{{collection_name | collection_select_current("Data") }}">
        Data
      </a>
      <a href="/conferences"id="conferences-collection" class="{{collection_name | collection_select_current("Conferences") }}">
        Conferences
      </a>
      <a href="/jobs" id="jobs-collection" class="{{collection_name | collection_select_current("Jobs") }}">
        Jobs
      </a>
      <a href="/institutions" id="institutions-collection" class="{{collection_name | collection_select_current("Institutions") }}">
        Institutions
      </a>
      <a href="/experiments" id="experiments-collection" class="{{collection_name | collection_select_current("Experiments") }}">
        Experiments
      </a>
      <a href="/journals" id="journals-collection" class="{{collection_name | collection_select_current("Journals") }}">
        Journals
      </a>
  </nav>
</section>
