{#
## This file is part of INSPIRE.
## Copyright (C) 2014 CERN.
##
## INSPIRE is free software; you can redistribute it and/or
## modify it under the terms of the GNU General Public License as
## published by the Free Software Foundation; either version 2 of the
## License, or (at your option) any later version.
##
## INSPIRE is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with INSPIRE; if not, write to the Free Software Foundation, Inc.,
## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.
#}
{% extends "deposit/run_base.html" %}

{%- block css %}
	{{ super() }}
	{% css 'img/jquery-ui/themes/base/jquery.ui.theme.css', '01-jquery-ui' %}
	{% css 'img/jquery-ui/themes/base/jquery.ui.datepicker.css', '01-jquery-ui' %}
	{%- css url_for('static', filename='css/typeahead.js-bootstrap.css'), '50-webdeposit' -%}
	{%- css url_for('static', filename='css/deposit/form.css'), '51-webdeposit' -%}
           {%- css url_for('static', filename='css/bootstrap-multiselect.css'), '50-webdeposit' -%}
	<style>
            @media (min-width: 1200px) {
              #file_container {
                width: 970px;
                float: none;
                margin: 0 auto;
              }
            }
	</style>
{%- endblock css %}

{%- block deposit_js -%}
  {%- js url_for('static', filename='js/buckets.js') -%}
	{{ super() }}
  {%- js url_for('webdeposit.static', filename='js/deposit/fields_group.js'), '50-webdeposit' -%}
	{% js url_for('webdeposit.static', filename='js/deposit/fillform.js'), '50-webdeposit' %}
            {%- js url_for('static', filename='js/bootstrap-multiselect.js'), '50-webdeposit' -%}
            {%- js url_for('static', filename='js/spin.js'), '50-webdeposit' -%}
{%- endblock deposit_js %}

{% block file_container_colsize %}col-md-12{% endblock %}

{% block form_title scoped %}
	{{ super() }}
    <p class="text-muted">
        <small>Instructions: (i) If you have an <strong>ArXiv id</strong>, a <strong>DOI</strong> or a <strong>ISBN</strong>,
        fill in the Identifier field and the data will be imported. (ii) Upload or remove extra files in the bottom of the form.
        (iii) When ready, press "Submit" to finalize your upload.</small>
    </p>
    <div id="import-message"></div>
    <div id="flash-import"></div>
{% endblock form_title %}

{% block sidebar %}
{% endblock %}

{% block javascript %}
{%- block form_script_options %}
<script type="text/javascript">
  var date_options = {dateFormat: 'yy-mm-dd'}
</script>
{%- endblock form_script_options %}
<script type="text/javascript">
$(document).ready(function() {
    var save_url = '{{ url_for(".save", deposition_type=deposition_type, uuid=uuid, draft_id=draft.id) }}';
    var save_all_url = '{{ url_for(".save", deposition_type=deposition_type, uuid=uuid, draft_id=draft.id, all='1') }}';
    var complete_url = '{{ url_for(".save", deposition_type=deposition_type, uuid=uuid, draft_id=draft.id, submit='1') }}';
    var autocomplete_url = '{{ url_for(".autocomplete", deposition_type=deposition_type, uuid=uuid, draft_id=draft.id, field_name="__FIELDNAME__", limit=10) }}';

    DEPOSIT_FORM.init_plupload(
        '{{config.DEPOSIT_MAX_UPLOAD_SIZE|default('10mb')}}',
        '.pluploader',
        save_url,
        '{{ url_for('.upload_file', deposition_type=deposition_type, uuid=uuid) }}',
        '{{ url_for('.delete_file', deposition_type=deposition_type, uuid=uuid) }}',
        '{{ url_for('.get_file', deposition_type=deposition_type, uuid=uuid) }}',
        {{ form.files|safe }},
        '{{ url_for('.upload_url', deposition_type=deposition_type, uuid=uuid) }}'
    );
    DEPOSIT_FORM.init_save(save_all_url, '.form-save', '#submitForm');
    DEPOSIT_FORM.init_submit(complete_url, '.form-submit', '#submitForm', '#form-submit-dialog');
    DEPOSIT_FORM.init_inputs('#submitForm input, #submitForm textarea, #submitForm select', save_url);
    DEPOSIT_FORM.init_buttons('#submitForm .form-button', save_url);
    DEPOSIT_FORM.init_autocomplete('[data-autocomplete="1"]', save_url, autocomplete_url);
    DEPOSIT_FORM.init_field_lists('#submitForm .dynamic-field-list', save_url, '[data-autocomplete="1"]', autocomplete_url);
    //DEPOSIT_FORM.init_ckeditor( '#submitForm textarea[data-ckeditor="1"]', save_url);

    // Date picker
    $(".datepicker").datepicker(date_options);
});
</script>
{% endblock javascript %}
